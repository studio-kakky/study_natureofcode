独習 Nature of code ~ ランダム・ウォーク ~

# ランダム・ウォーク

Nature of codeの序章としては、ランダム・ウォークが取り上げられています。実際出来上がるものは、黒い点が右往左往して軌跡を描くすごく単純なものですが、意外と面白いです。

# ランダムウォーカークラス
本の中ではランダムウォーカークラスを実装することから始まります。
黒点が右往左往するクラスです。

そのためには

- 黒点の現在の位置
    - x座標
    - y座標

を状態=クラスのプロパティを保存し

- 黒点が次にどの位置に動くか

という機能=クラスのメソッドが必要です。

さらにこれだけだと、メモリ上の現在位置が更新されるだけなので、視覚化するために

- 黒点の現在位置をプロットする

という機能が必要です。


## コンストラクターとプロパティの設定

まずはRandomWalkクラスを作成します。


    class RandomWalk {

        constructor(initX,initY){
            this.x = initX;
            this.y = initY;
        }
    }


まずは、xとy座標というクラスのプロパティを定義します。本の中ではプロパティを定義して、初期値に幅と高さの半分=つまりキャンバスの中央を初期値の中でいれています。僕は、コンストラクターの中でプロパティの定義・初期値の設定、両方行いました。
さらに、初期値はクラスをインスタンス化するときに決めたいので、コンスタラクターの引数を渡すことにします。

## 現在位置をプロットする機能

次に現在位置をプロットする機能を実装します。

    display() {
        stroke(0);
        point(this.x,this.y);
    }

strokeは描画するときの色を指定するProcessingのメソッドです。黒い点がいいので、0を指定します。
point()は指定された座標に点を描画するメソッドです。ここでは現在の点の位置を記録したいので、コンストラクターで定義した
このクラスの現在位置this.xとthis.yを指定します。

## 黒点の移動
最後に今回のメインというべき部分、黒点がランダムに移動するメソッドです。

    step(){
        var choice = parseInt( Math.random()*4 );

        if( choice === 0){
            this.x++;
        }else if( choice === 1){
            this.x--;
        }else if( choice === 2){
            this.y++;
        }else{
            this.y--;
        }
    }

    var choice = parseInt( Math.random()*4 );

ここでは、choiceに0,1,2,3のいずれかの変数が格納されます。
Math.randomは0 以上 1未満の数値をランダムで返すメソッドです。本の中ではp5jsのrandomメソッドが利用されていますが、JavaScriptネイティブなMath.randomの方が高速に動作するので、そちらをを利用します。

    Math.random()*4

は0以上1未満の数字を4倍するので、0以上4未満の数字を返します。
parseIntは、小数点以下を切り捨てし、整数を返すJavaScriptのメソッドです。たとえば、

    parseInt( 0.12344 )

は0を返します。
これで

    parseInt( Math.random()*4 );

は0,1,2,3のいずれかを返すことになります。

    if( choice === 0){
        this.x++;
    }else if( choice === 1){
        this.x--;
    }else if( choice === 2){
        this.y++;
    }else{
        this.y--;
    }

この部分はchoiceの内容によって、ランダムに1歩移動することを表しています。
ちょうど下の図のような感じです。





さて、なぜランダムというテーマが序章として取り上げられているのでしょうか。その核心に迫ることが本の冒頭に書いてあります。

> 私たちを取り巻く世界は、複雑かつ不思議な動きにあふれています。私たいは、知覚と相互作用を通して環境について学びながら幼少期を過ごします。
> そして、落とした岩は重力によって下へ下へと転がっていく、突風が吹けば軽いものほど遠くへ飛ばされるなど、周囲の物理的世界が私たちの知覚の記憶と同じように動くことを期待するようになります。
> ・・・ 中略　・・・
> 目指すのは、ユーザーの知覚の記憶を利用して、直感的で満足度の高い豊かな体験を作り出すことです。
> ー ジェームズ・トゥー（James Tu）、「Dynamic Bodies」過程案内（ITP 2003年春）

これは著者のシフマンさんの母校であるITPの授業案内の様なものでしょうか。
ここで書かれているように、私たちの周りの世界はとても複雑な動きをしていて、私たちはそれに慣れきっています。そうすると単純な動きのものにものすごい違和感を感じます。

たとえば、初等物理で勉強する等速直線運動「外から力をうけない物体は、動いているものは同じスピード同じ方向に動き続ける」いわゆる感性の法則ですが、これは簡単にアニメーションを作成することができます。しかしものすごい違和感を感じるはずです。物理学的には全く正しいにもかかわらずです。
なぜかというと、現実世界にはそんな動きをするものが無いからです。地球上の物体は様々な力を常に受けています。




